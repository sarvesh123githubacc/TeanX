let r=null;chrome.runtime.onMessage.addListener((e,o,a)=>{e.type==="NEWS_DATA"?(console.log("Received news data:",e.payload),n(e.payload).then(t=>{r=t,chrome.runtime.sendMessage({type:"CREDIBILITY_RESULT",payload:r})})):e.type==="REQUEST_LATEST_DATA"&&r&&chrome.runtime.sendMessage({type:"CREDIBILITY_RESULT",payload:r})});async function n(e){try{let t=await(await fetch("http://localhost:5000/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e.articleText})})).json();return{title:e.title,source:e.source,credibility:t.credibility_score||50,factCheck:t.fact_check_sources||[],alternativeSources:t.alternative_sources||[]}}catch(o){return console.error("Error contacting AI model:",o),{error:"AI Analysis Failed"}}}
